data:
  train_ratio: 0.85
  test_val_ratio: 0.35
  data_dir: /root/dataset/dataset
  dataset_name: "Neurovoz"     # "Ita-PVS" | "Neurovoz" | "Addresso"
  target_sr: 16000
  mono: true
  normalize: "peak"           # "peak" | "rms"
  fixed_duration_s: 5.0
  resample: true
  pad_mode: "silence"         # zeri
  label_map: { healthy: 0, parkinson: 1 }

model:
  dropout: 0.25
  branch: "transformers_mlp"     # "classical_svm" | "classical_mlp" | "cnn" | "transformers_mlp"
  cnn:
    in_type: "waveform"       # "waveform" | "spectrogram"
  mlp:
    hidden: [384, 192]                    # Architettura bilanciata per prestazioni/velocità
    dropout: 0.25                         # Dropout ottimizzato per prevenire overfitting
  svm:
    kernel: "rbf"
    C: 1.0
    gamma: "scale"

features:
  classical:
    n_mfcc: 13
    mfcc_delta: true
    energy: true
    pitch: false
    jitter_shimmer: true
  spectrogram:
    n_mels: 40                             # Aumentato per migliori feature mantenendo velocità
    n_fft: 320                             # Aumentato moderatamente per risoluzione migliore
    hop_length: 160                        # Valore standard per buon compromesso
    log: true
  transformers:
    model_name: "facebook/wav2vec2-base-960h"   # Modello bilanciato per prestazioni/velocità
    pooling: "mean"                             # "cls" | "mean"
    freeze_backbone: false                      # Unfreeze per migliori prestazioni
    max_length: 56000                          # Aumentato leggermente per più contesto (3.5s * 16kHz)
    layer: -1                                  # Usa ultimo layer per rappresentazioni migliori
                                                # Modelli disponibili:
                                                # - facebook/wav2vec2-base-960h
                                                # - ALM/wav2vec2-base-audioset
                                                # - facebook/hubert-base-ls960
                                                # - ALM/hubert-base-audioset
                                                # - microsoft/wavlm-base-plus
                                                # - microsoft/wavlm-base

training:
  epochs: 30 # Aumentato per migliore convergenza mantenendo velocità
  batch_size: 56                           # Ridotto leggermente per gradiente più preciso
  optimizer: adamw                         # AdamW per migliore regolarizzazione
  max_lr: 0.0012                          # LR leggermente aumentato per convergenza più veloce
  min_lr: 0.000012                        # Min LR proporzionale
  warmup_ratio: 0.12                      # Warmup ridotto per training più veloce
  weight_decay: 0.005                     # Regolarizzazione L2 moderata
  checkpoint_dir: checkpoints/
  model_name: best_model
  device: "cuda"              # "cuda" | "mps" | "cpu"
  evaluation_metric: accuracy
  best_metric_lower_is_better: false
  seed: 42  
  # Validation Split
  validation_split: 0.2                     # Validation split standard per monitoraggio accurato

plot: [accuracy, loss]