data:
  train_ratio: 0.85
  test_val_ratio: 0.35
  data_dir: /root/dataset/dataset
  dataset_name: "Addresso"     # "Ita-PVS" | "Neurovoz" | "Addresso"
  target_sr: 16000
  mono: true
  normalize: "peak"           # "peak" | "rms"
  fixed_duration_s: 5.0
  resample: true
  pad_mode: "silence"         # zeri
  label_map: { healthy: 0, alzheimer: 1 }

model:
  dropout: 0.3                            # Bilanciato per evitare underfitting severo
  branch: "classical_mlp"     # "classical_svm" | "classical_mlp" | "cnn" | "transformers_mlp"
  cnn:
    in_type: "waveform"                      # "waveform" | "spectrogram" - waveform per semplicità
  mlp:
    hidden_layers: [128, 64]          # Architettura leggermente più complessa per features HuBERT
    dropout: 0.5                          # Dropout più alto per dataset piccolissimo - previene overfitting
    class_weight: "balanced"               # CRITICO: bilancia classi per migliorare recall classe 0
  svm:
    kernel: "rbf"                          # Cambiato: RBF per pattern non-lineari piu complessi
    C: 50.0                                # Aumentato: piu flessibilita per 80% accuracy target
    gamma: "scale"                         # Cambiato: scale per migliore gestione features
    class_weight: "balanced"               # Bilanciamento automatico classi

features:
  classical:
    n_mfcc: 20                             # Aumentato: piu coefficienti per dettagli audio
    mfcc_delta: true                       # Delta features per dinamica temporale
    mfcc_delta2: true                      # Delta-delta per accelerazione
    chroma: true                           # Features armoniche
    spectral_centroid: true                # Centro spettrale
    spectral_bandwidth: true               # Larghezza banda spettrale
    spectral_rolloff: true                 # Rolloff spettrale
    zero_crossing_rate: true               # Tasso attraversamento zero
    rms_energy: true                       # Aggiunto: energia RMS per intensita audio
    tempo: true                            # Aggiunto: tempo per ritmo audio
    tonnetz: true                          # Nuove: features armoniche complesse
    poly_features: true                    # Nuove: caratteristiche ritmiche
    spectral_contrast_enhanced: true       # Nuove: contrasto spettrale migliorato
    pitch: false                           # Disabilitato: puo causare errori su alcuni audio
    jitter_shimmer: false                  # Disabilitato: richiede Parselmouth stabile
  spectrogram:
    n_mels: 16                             # Ridotto da 32 per dataset piccolo (meno complessita)
    n_fft: 128                             # Ridotto da 256 per evitare overfitting
    hop_length: 128                        # Valore standard ottimizzato
    log: true
  transformers:
    model_name: "ALM/hubert-base-audioset"        
    pooling: "mean"                             # "cls" | "mean"
    freeze_backbone: false                      # Unfreeze per fine-tuning completo
    max_length: 32000                          # Ridotto da 48000 per dataset piccolo (2s * 16kHz)
    layer: -1                                  # Usa ultimo layer per rappresentazioni migliori
                                                # Modelli disponibili:
                                                # - facebook/wav2vec2-base-960h
                                                # - ALM/wav2vec2-base-audioset
                                                # - facebook/hubert-base-ls960
                                                # - ALM/hubert-base-audioset
                                                # - microsoft/wavlm-base-plus
                                                # - microsoft/wavlm-base

training:
  epochs: 10                              # Drasticamente ridotto: dataset piccolissimo (22 test samples)
  batch_size: 16                          # Ridotto per dataset molto piccolo (22 test samples)
  lr: 0.0003                              # LR molto più basso per convergenza graduale
  max_lr: 0.0008                          # Scheduler più conservativo
  min_lr: 0.000005                        # LR minimo molto basso
  warmup_ratio: 0.2                       # Warmup più lungo per stabilità
  weight_decay: 0.05                      # Regolarizzazione molto alta per overfitting
  checkpoint_dir: checkpoints/
  model_name: best_model
  device: "cuda"              # "cuda" | "mps" | "cpu"
  evaluation_metric: accuracy
  best_metric_lower_is_better: false
  seed: 42  
  # Validation Split
  validation_split: 0.15                     # Ridotto da 0.20 per massimizzare training data

plot: [accuracy, loss]